package org.iets3.ears.gxw.intentions;

/*Generated by MPS */

import jetbrains.mps.intentions.IntentionDescriptorBase;
import jetbrains.mps.intentions.IntentionFactory;
import java.util.Collection;
import jetbrains.mps.intentions.IntentionExecutable;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.intentions.IntentionType;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import java.util.Collections;
import org.apache.log4j.Logger;
import org.apache.log4j.LogManager;
import jetbrains.mps.intentions.IntentionExecutableBase;
import java.io.File;
import java.io.FileWriter;
import java.io.BufferedWriter;
import java.util.Map;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.LinkedHashMap;
import java.util.HashMap;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.ears.gxw.behavior.PropositionalFormulaSR__BehaviorDescriptor;
import org.iets3.ears.gxw.behavior.PropositionalFormulaTr__BehaviorDescriptor;
import org.apache.commons.lang3.StringUtils;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.IMapping;
import org.iets3.ears.gxw.behavior.RequirementChunk__BehaviorDescriptor;
import java.io.IOException;
import jetbrains.mps.intentions.IntentionDescriptor;

public final class structuralCoder_Intention extends IntentionDescriptorBase implements IntentionFactory {
  private Collection<IntentionExecutable> myCachedExecutable;
  public structuralCoder_Intention() {
    super(MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x5d97a5a8692b865bL, "org.iets3.ears.gxw.structure.RequirementChunk"), IntentionType.NORMAL, true, new SNodePointer("r:68b642f0-e6ba-47af-af54-70236074fdc6(org.iets3.ears.gxw.intentions)", "6686289246526160991"));
  }
  @Override
  public String getPresentation() {
    return "structuralCoder";
  }
  @Override
  public boolean isApplicable(final SNode node, final EditorContext editorContext) {
    if (!(isApplicableToNode(node, editorContext))) {
      return false;
    }
    return true;
  }
  private boolean isApplicableToNode(final SNode node, final EditorContext editorContext) {
    return true;
  }
  @Override
  public boolean isSurroundWith() {
    return false;
  }
  public Collection<IntentionExecutable> instances(final SNode node, final EditorContext context) {
    if (myCachedExecutable == null) {
      myCachedExecutable = Collections.<IntentionExecutable>singletonList(new structuralCoder_Intention.IntentionImplementation());
    }
    return myCachedExecutable;
  }
  protected static Logger LOG = LogManager.getLogger(structuralCoder_Intention.class);
  /*package*/ final class IntentionImplementation extends IntentionExecutableBase {
    public IntentionImplementation() {
    }
    @Override
    public String getDescription(final SNode node, final EditorContext editorContext) {
      return "Transform";
    }
    @Override
    public void execute(final SNode node, final EditorContext editorContext) {
      try {
        String inputFilePath = "textGenOutput.txt";


        File inputFile = new File(inputFilePath);
        if (inputFile.exists()) {
          inputFile.delete();
        }
        FileWriter fileWriter = new FileWriter(inputFile.getAbsoluteFile());
        BufferedWriter bufferedWriter = new BufferedWriter(fileWriter);
        if (LOG.isInfoEnabled()) {
          LOG.info("" + System.getProperty("user.dir"));
        }

        Map<SNode, String> triggerMap = MapSequence.fromMap(new LinkedHashMap<SNode, String>(16, (float) 0.75, false));
        Map<SNode, String> systemResponseMap = MapSequence.fromMap(new HashMap<SNode, String>());
        for (SNode trigger : ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(node, MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x5d97a5a8692b865bL, 0x29245ddc2083503cL, "glossary")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x1dfca649d8e7ff3L, 0x1dfca649d8e7ff4L, "listOfTriggers")))) {
          MapSequence.fromMap(triggerMap).put(trigger, SPropertyOperations.getString(trigger, MetaAdapterFactory.getProperty(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0xe98cc5716ef655aL, 0x5d97a5a8692a5e10L, "text")).replace(" ", ""));
        }

        for (SNode systemResponse : ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(node, MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x5d97a5a8692b865bL, 0x29245ddc2083503cL, "glossary")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x1dfca649d8e7ff3L, 0x1dfca649d8e7ffbL, "listOfResponses")))) {
          MapSequence.fromMap(systemResponseMap).put(systemResponse, (SPropertyOperations.getString(SLinkOperations.getTarget(systemResponse, MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0xe98cc5716ef6557L, 0x6c21f2425f711684L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + SPropertyOperations.getString(systemResponse, MetaAdapterFactory.getProperty(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0xe98cc5716ef6557L, 0x6c21f2425f711686L, "action"))).replace(" ", ""));
        }

        int count = 0;
        for (SNode req : ListSequence.fromList(SLinkOperations.getChildren(node, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x5d97a5a8692b865bL, 0x5d97a5a8692b865cL, "requirements")))) {
          bufferedWriter.write("##  ");

          if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, "org.iets3.ears.gxw.structure.NormalUbiquitousReq"))) {

            System.out.println(" the count is " + count++ + "for NUR");
            bufferedWriter.write("The " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, "org.iets3.ears.gxw.structure.NormalUbiquitousReq")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, "org.iets3.ears.gxw.structure.NormalUbiquitousReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, 0x6979ba361f3afff3L, "systemResponse"))) + "\n");
            SNode responseFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, "org.iets3.ears.gxw.structure.NormalUbiquitousReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6d72a819db7d92a9L, 0x6979ba361f3afff3L, "systemResponse"));


            bufferedWriter.write("[] !" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap));

            bufferedWriter.write("\n\n");
          } else if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq"))) {

            System.out.println(" the count is " + count++ + "for NEDOFR");

            SNode the_req = SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq"));
            SNode responseFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x6979ba361f3b0015L, "systemResponse"));
            SNode triggerFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, 0x333c641fcaaa86e3L, "untilTrigger"));


            if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2871dd7L, "org.iets3.ears.gxw.structure.Occurs")) {

              bufferedWriter.write("When " + PropositionalFormulaTr__BehaviorDescriptor.toTextString_id3cWp1ZaFwKU.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger"))) + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x10802efe25aL, 0x10d34fa226eL, "alias")) + " , the " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x6979ba361f3b0015L, "systemResponse"))) + "  until " + PropositionalFormulaTr__BehaviorDescriptor.toTextString_id3cWp1ZaFwKU.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, "org.iets3.ears.gxw.structure.NormalEventDrivenOptionalFeatReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f44f4aeL, 0x333c641fcaaa86e3L, "untilTrigger"))) + " \n");
              bufferedWriter.write("[] " + "(" + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap) + " -> " + "(" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + " W " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(triggerFormula, triggerMap) + "))");
            } else if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2782aa2L, "org.iets3.ears.gxw.structure.Happens")) {

              bufferedWriter.write("\n");

              String triggerName = PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap);

              bufferedWriter.write("[] " + "(( !" + triggerName + " && X " + triggerName + ")" + " -> " + "X(" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + " W " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(triggerFormula, triggerMap) + "))");

            } else if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2782aa5L, "org.iets3.ears.gxw.structure.HappensStable")) {
              String triggerName = PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap);

              bufferedWriter.write("[] " + "(" + triggerName + " && !" + triggerName + " && XX(" + triggerName + "))" + " -> " + "XX(" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + " W " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(triggerFormula, triggerMap) + ")");
            }

            bufferedWriter.write("\n\n");
          } else if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq"))) {

            bufferedWriter.write("When " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap) + ", the " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x6979ba361f3b0015L, "systemResponse"))) + "\n");

            SNode the_req = SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, "org.iets3.ears.gxw.structure.NormalEventDrivenReq"));
            SNode responseFormula = SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x6979ba361f3b0015L, "systemResponse"));
            if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2871dd7L, "org.iets3.ears.gxw.structure.Occurs")) {

              bufferedWriter.write("[] " + "(" + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap) + " -> " + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + ")");
            } else if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2782aa2L, "org.iets3.ears.gxw.structure.Happens")) {
              String triggerName = PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap);

              bufferedWriter.write("[] " + "((" + triggerName + " && !" + triggerName + ")" + " -> X (" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + "))");
            } else if (SNodeOperations.getConcept(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d6L, 0x7f8bb363a2782aa8L, "triggerModifier"))) == MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x7f8bb363a2782aa5L, "org.iets3.ears.gxw.structure.HappensStable")) {
              String triggerName = PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(the_req, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x415265a05dfb4103L, 0x7f8bb363a25a61abL, "trigger")), triggerMap);

              bufferedWriter.write("[] " + "(" + triggerName + " && !" + triggerName + " && XX(" + triggerName + "))" + " -> XX(" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + "))");
            }
            bufferedWriter.write("\n\n");
          } else if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq"))) {

            bufferedWriter.write("When IFF " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, 0x168a7cb10e4dea9fL, "trigger")), triggerMap) + ", the " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, 0x168a7cb10e4dea9eL, "systemResponse"))) + "\n");

            SNode responseFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, 0x168a7cb10e4dea9eL, "systemResponse"));
            bufferedWriter.write("[] " + "(( !" + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, 0x168a7cb10e4dea9fL, "trigger")), triggerMap) + " && X " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, "org.iets3.ears.gxw.structure.NormalRisingEdgeReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x168a7cb10e4dea9bL, 0x168a7cb10e4dea9fL, "trigger")), triggerMap) + " )" + " <-> " + " X (" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + "))");
            bufferedWriter.write("\n\n");
          } else if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq"))) {


            bufferedWriter.write("While " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a7aL, "triggerWhile")), triggerMap) + " when " + SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a7fL, "triggerWhen")) + ", the " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a85L, "systemResponse"))) + "\n");

            SNode responseFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a85L, "systemResponse"));
            bufferedWriter.write("[] " + "(( " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a7aL, "triggerWhile")), triggerMap) + " &&  " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a7fL, "triggerWhen")), triggerMap) + " )" + " ->" + "(" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + " W " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, "org.iets3.ears.gxw.structure.ComplexEventDrivenReq")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x12815fbacd8318dfL, 0x12815fbacd831a7aL, "triggerWhile")), MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x333c641fcaa983a1L, "org.iets3.ears.gxw.structure.NotFormulaTr")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x333c641fcaa983a8L, 0x333c641fcaa983afL, "arg")), triggerMap) + "))");
            bufferedWriter.write("\n\n");
          } else if (SNodeOperations.isInstanceOf(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil"))) {

            bufferedWriter.write("While " + PropositionalFormulaTr__BehaviorDescriptor.toTextString_id3cWp1ZaFwKU.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562abL, "triggerWhile"))) + " when " + PropositionalFormulaTr__BehaviorDescriptor.toTextString_id3cWp1ZaFwKU.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562acL, "triggerWhen"))) + ", the " + SPropertyOperations.getString(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x6979ba361f3d77d3L, 0x6979ba361f3c9b03L, "systemName")), MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name")) + " shall " + PropositionalFormulaSR__BehaviorDescriptor.toTextString_id6_TIzovgSIh.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562adL, "systemResponse"))) + " until " + PropositionalFormulaTr__BehaviorDescriptor.toTextString_id3cWp1ZaFwKU.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562b1L, "untilTrigger"))) + "\n");

            SNode responseFormula = SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562adL, "systemResponse"));
            String finalString = "";
            String modifierTrigger = PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562abL, "triggerWhile")), triggerMap);

            if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562abL, "triggerWhile")), MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x333c641fcaa9839eL, "org.iets3.ears.gxw.structure.AndFormulaTr"))) {

              modifierTrigger = modifierTrigger.replace("(", "");
              modifierTrigger = modifierTrigger.replace(")", "");
              modifierTrigger = modifierTrigger.replace("&", "|");

              finalString = modifierTrigger;


            } else {
              int countMatches = StringUtils.countMatches(modifierTrigger, "!");
              if (countMatches / 2 != 0) {

                finalString = modifierTrigger.substring(countMatches - 1);
              } else {

                finalString = modifierTrigger.substring(countMatches);
              }

              if (countMatches == 0) {
                finalString = "!" + finalString;
              }
            }

            bufferedWriter.write("[]( " + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562acL, "triggerWhen")), triggerMap) + " -> ( " + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(responseFormula, systemResponseMap) + " W (" + PropositionalFormulaTr__BehaviorDescriptor.toFormulaString_id3cWp1ZaFwJv.invoke(SLinkOperations.getTarget(SNodeOperations.cast(req, MetaAdapterFactory.getConcept(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, "org.iets3.ears.gxw.structure.ComplexEventDrivenUntil")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x769597d03a1542e4L, 0x769597d03a1562b1L, "untilTrigger")), triggerMap) + " || " + finalString + " )))");
            bufferedWriter.write("\n\n");
          }

        }

        List<SNode> listOfAxioms = SLinkOperations.getChildren(SLinkOperations.getTarget(node, MetaAdapterFactory.getReferenceLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x5d97a5a8692b865bL, 0x29245ddc2083503cL, "glossary")), MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x1dfca649d8e7ff3L, 0x16773e7879d1a85aL, "listOfAxioms"));

        for (SNode axiom : ListSequence.fromList(listOfAxioms)) {

          bufferedWriter.write("[] (" + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(SLinkOperations.getTarget(axiom, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x16773e7879d18484L, 0x16773e7879d3bd57L, "arg1")), systemResponseMap) + " <-> " + PropositionalFormulaSR__BehaviorDescriptor.toFormulaString_id6_TIzovfT5$.invoke(SLinkOperations.getTarget(axiom, MetaAdapterFactory.getContainmentLink(0x7731a166da1f472eL, 0xa40a2283f5e47dc5L, 0x16773e7879d18484L, 0x16773e7879d3bd5cL, "arg2")), systemResponseMap) + " )");
          bufferedWriter.write("\n\n");

        }


        bufferedWriter.write("INPUT ");
        for (IMapping<SNode, String> trigger : MapSequence.fromMap(triggerMap)) {
          bufferedWriter.write(trigger.value());
          if (MapSequence.fromMap(triggerMap).last().value() != trigger.value()) {
            bufferedWriter.write(", ");
          }
        }

        bufferedWriter.write("\n");

        bufferedWriter.write("OUTPUT ");
        for (IMapping<SNode, String> response : MapSequence.fromMap(systemResponseMap)) {
          bufferedWriter.write(response.value());
          if (MapSequence.fromMap(systemResponseMap).last().value() != response.value()) {
            bufferedWriter.write(", ");
          }
        }
        bufferedWriter.write("\n");



        bufferedWriter.close();
        // now read from the file and make use of it 
        String outputFile = "Output.txt";

        // now use the APIs, the new one 
        if (LOG.isInfoEnabled()) {
          LOG.info("just added");
        }
        RequirementChunk__BehaviorDescriptor.writeToFile_id3ghj88fUYVW.invoke(node, outputFile, RequirementChunk__BehaviorDescriptor.systhesizeSolverOutput_id3ghj88fVJYt.invoke(node, inputFile));

      } catch (IOException e) {
        if (LOG.isInfoEnabled()) {
          LOG.info("the exception is ", e);
        }
      }





    }
    @Override
    public IntentionDescriptor getDescriptor() {
      return structuralCoder_Intention.this;
    }
  }
}
